@echo off
REM COMSOL Batch Execution Script
REM Generated by ESP Job Generator
REM Job ID: {{ job_id }}
REM Generated at: {{ generated_at }}

echo ============================================================
echo COMSOL Simulation Batch Execution
echo ============================================================
echo Job ID: {{ job_id }}
echo Job Directory: {{ job_dir }}
echo Java File: {{ java_file_name }}
echo Class Name: {{ class_name }}
echo Output File: {{ output_file }}
echo ============================================================

cd /d "{{ job_dir }}"

echo [%date% %time%] Starting COMSOL execution...

{{ comsol_command }} batch ^
    -inputfile "{{ java_file_name }}" ^
    -outputfile "{{ output_file }}" ^
    > "{{ job_dir }}\results\run.log" 2>&1

set EXIT_CODE=%ERRORLEVEL%

if %EXIT_CODE% neq 0 (
    echo [%date% %time%] ERROR: COMSOL execution failed with exit code %EXIT_CODE%
    echo Check log file: {{ job_dir }}\results\run.log
    exit /b %EXIT_CODE%
)

echo [%date% %time%] COMSOL execution completed successfully
echo Results saved to: {{ job_dir }}\results\
echo ============================================================
exit /b 0
